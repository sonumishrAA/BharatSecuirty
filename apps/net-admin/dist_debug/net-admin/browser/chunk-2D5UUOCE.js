import{c as I,e as W,j as T,l as B,t as F}from"./chunk-OBZSDWM5.js";import{b as V}from"./chunk-RT5UYCHB.js";import{$a as S,Ab as a,Bb as C,Eb as g,Fb as m,Gb as p,Ib as E,Na as s,Oa as v,_ as y,a as M,bb as u,gc as P,ha as c,hc as O,ia as _,kb as i,lb as n,nb as h,ob as w,oc as k,qb as b,rb as x,sb as d}from"./chunk-V2IGFCHU.js";function L(l,f){if(l&1){let e=b();i(0,"button",8),x("click",function(){c(e);let t=d();return _(t.startCreate())}),a(1," + Add Stat "),n()}}function D(l,f){if(l&1&&(i(0,"div",9),a(1),n()),l&2){let e=d();s(),C(e.error)}}function z(l,f){l&1&&(i(0,"div",10),a(1,"Loading stats..."),n())}function A(l,f){if(l&1){let e=b();i(0,"div",11)(1,"h3"),a(2,"New Stat"),n(),i(3,"div",12)(4,"label"),a(5,"Value"),n(),i(6,"input",13),p("ngModelChange",function(t){c(e);let r=d();return m(r.newStat.value,t)||(r.newStat.value=t),_(t)}),n()(),i(7,"div",12)(8,"label"),a(9,"Suffix"),n(),i(10,"input",14),p("ngModelChange",function(t){c(e);let r=d();return m(r.newStat.suffix,t)||(r.newStat.suffix=t),_(t)}),n()(),i(11,"div",12)(12,"label"),a(13,"Label"),n(),i(14,"input",15),p("ngModelChange",function(t){c(e);let r=d();return m(r.newStat.label,t)||(r.newStat.label=t),_(t)}),n()(),i(15,"div",12)(16,"label"),a(17,"Icon (emoji)"),n(),i(18,"input",16),p("ngModelChange",function(t){c(e);let r=d();return m(r.newStat.icon,t)||(r.newStat.icon=t),_(t)}),n()(),i(19,"div",12)(20,"label"),a(21,"Sort Order"),n(),i(22,"input",17),p("ngModelChange",function(t){c(e);let r=d();return m(r.newStat.sort_order,t)||(r.newStat.sort_order=t),_(t)}),n()(),i(23,"div",18)(24,"button",19),x("click",function(){c(e);let t=d();return _(t.createStat())}),a(25,"Create"),n(),i(26,"button",20),x("click",function(){c(e);let t=d();return _(t.cancelCreate())}),a(27,"Cancel"),n()()()}if(l&2){let e=d();s(6),g("ngModel",e.newStat.value),s(4),g("ngModel",e.newStat.suffix),s(4),g("ngModel",e.newStat.label),s(4),g("ngModel",e.newStat.icon),s(4),g("ngModel",e.newStat.sort_order)}}function N(l,f){if(l&1){let e=b();h(0),i(1,"td",24),a(2),n(),i(3,"td"),a(4),n(),i(5,"td"),a(6),n(),i(7,"td"),a(8),n(),i(9,"td"),a(10),n(),i(11,"td",25)(12,"button",26),x("click",function(){c(e);let t=d().$implicit,r=d(2);return _(r.startEdit(t))}),a(13,"Edit"),n(),i(14,"button",27),x("click",function(){c(e);let t=d().$implicit,r=d(2);return _(r.deleteStat(t))}),a(15,"Delete"),n()(),w()}if(l&2){let e=d().$implicit;s(2),C(e.icon),s(2),C(e.value),s(2),C(e.suffix),s(2),C(e.label),s(2),C(e.sort_order)}}function U(l,f){if(l&1){let e=b();h(0),i(1,"td")(2,"input",28),p("ngModelChange",function(t){c(e);let r=d(3);return m(r.editingStat.icon,t)||(r.editingStat.icon=t),_(t)}),n()(),i(3,"td")(4,"input",29),p("ngModelChange",function(t){c(e);let r=d(3);return m(r.editingStat.value,t)||(r.editingStat.value=t),_(t)}),n()(),i(5,"td")(6,"input",28),p("ngModelChange",function(t){c(e);let r=d(3);return m(r.editingStat.suffix,t)||(r.editingStat.suffix=t),_(t)}),n()(),i(7,"td")(8,"input",28),p("ngModelChange",function(t){c(e);let r=d(3);return m(r.editingStat.label,t)||(r.editingStat.label=t),_(t)}),n()(),i(9,"td")(10,"input",29),p("ngModelChange",function(t){c(e);let r=d(3);return m(r.editingStat.sort_order,t)||(r.editingStat.sort_order=t),_(t)}),n()(),i(11,"td",25)(12,"button",30),x("click",function(){c(e);let t=d(3);return _(t.saveStat())}),a(13,"Save"),n(),i(14,"button",31),x("click",function(){c(e);let t=d(3);return _(t.cancelEdit())}),a(15,"Cancel"),n()(),w()}if(l&2){let e=d(3);s(2),g("ngModel",e.editingStat.icon),s(2),g("ngModel",e.editingStat.value),s(2),g("ngModel",e.editingStat.suffix),s(2),g("ngModel",e.editingStat.label),s(2),g("ngModel",e.editingStat.sort_order)}}function j(l,f){if(l&1&&(i(0,"tr"),S(1,N,16,5,"ng-container",23)(2,U,16,5,"ng-container",23),n()),l&2){let e=f.$implicit,o=d(2);s(),u("ngIf",(o.editingStat==null?null:o.editingStat.id)!==e.id),s(),u("ngIf",(o.editingStat==null?null:o.editingStat.id)===e.id)}}function H(l,f){if(l&1&&(i(0,"table",21)(1,"thead")(2,"tr")(3,"th"),a(4,"Icon"),n(),i(5,"th"),a(6,"Value"),n(),i(7,"th"),a(8,"Suffix"),n(),i(9,"th"),a(10,"Label"),n(),i(11,"th"),a(12,"Order"),n(),i(13,"th"),a(14,"Actions"),n()()(),i(15,"tbody"),S(16,j,3,2,"tr",22),n()()),l&2){let e=d();s(16),u("ngForOf",e.stats)}}function R(l,f){l&1&&(i(0,"div",32)(1,"p"),a(2,'No stats yet. Click "Add Stat" to create one.'),n()())}var Y=(()=>{class l{constructor(e){this.http=e,this.stats=[],this.editingStat=null,this.isCreating=!1,this.newStat={value:0,suffix:"+",label:"",icon:"\u{1F4CA}",sort_order:0},this.loading=!1,this.error="",this.apiUrl="http://localhost:3000/api/business"}ngOnInit(){this.loadStats()}loadStats(){this.loading=!0,this.http.get(`${this.apiUrl}/home-stats`).subscribe({next:e=>{this.stats=e,this.loading=!1},error:e=>{this.error="Failed to load stats",this.loading=!1}})}startCreate(){this.isCreating=!0,this.editingStat=null,this.newStat={value:0,suffix:"+",label:"",icon:"\u{1F4CA}",sort_order:this.stats.length+1}}cancelCreate(){this.isCreating=!1,this.newStat={value:0,suffix:"+",label:"",icon:"\u{1F4CA}",sort_order:0}}createStat(){let e=localStorage.getItem("token");this.http.post(`${this.apiUrl}/home-stats`,this.newStat,{headers:{Authorization:`Bearer ${e}`}}).subscribe({next:o=>{this.stats.push(o),this.isCreating=!1,this.newStat={value:0,suffix:"+",label:"",icon:"\u{1F4CA}",sort_order:0}},error:()=>this.error="Failed to create stat"})}startEdit(e){this.editingStat=M({},e),this.isCreating=!1}cancelEdit(){this.editingStat=null}saveStat(){if(!this.editingStat)return;let e=localStorage.getItem("token");this.http.put(`${this.apiUrl}/home-stats/${this.editingStat.id}`,this.editingStat,{headers:{Authorization:`Bearer ${e}`}}).subscribe({next:o=>{let t=this.stats.findIndex(r=>r.id===o.id);t>=0&&(this.stats[t]=o),this.editingStat=null},error:()=>this.error="Failed to update stat"})}deleteStat(e){if(!confirm(`Delete "${e.label}"?`))return;let o=localStorage.getItem("token");this.http.delete(`${this.apiUrl}/home-stats/${e.id}`,{headers:{Authorization:`Bearer ${o}`}}).subscribe({next:()=>{this.stats=this.stats.filter(t=>t.id!==e.id)},error:()=>this.error="Failed to delete stat"})}static{this.\u0275fac=function(o){return new(o||l)(v(V))}}static{this.\u0275cmp=y({type:l,selectors:[["app-stats"]],standalone:!0,features:[E],decls:12,vars:6,consts:[[1,"stats-page"],[1,"page-header"],["class","btn-primary",3,"click",4,"ngIf"],["class","error-msg",4,"ngIf"],["class","loading",4,"ngIf"],["class","stat-form",4,"ngIf"],["class","stats-table",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"btn-primary",3,"click"],[1,"error-msg"],[1,"loading"],[1,"stat-form"],[1,"form-row"],["type","number","placeholder","250",3,"ngModelChange","ngModel"],["type","text","placeholder","+ or % or h",3,"ngModelChange","ngModel"],["type","text","placeholder","Security Audits",3,"ngModelChange","ngModel"],["type","text","placeholder","\u{1F6E1}\uFE0F",3,"ngModelChange","ngModel"],["type","number","placeholder","1",3,"ngModelChange","ngModel"],[1,"form-actions"],[1,"btn-success",3,"click"],[1,"btn-secondary",3,"click"],[1,"stats-table"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"icon-cell"],[1,"actions-cell"],[1,"btn-sm","btn-edit",3,"click"],[1,"btn-sm","btn-danger",3,"click"],["type","text",1,"input-sm",3,"ngModelChange","ngModel"],["type","number",1,"input-sm",3,"ngModelChange","ngModel"],[1,"btn-sm","btn-success",3,"click"],[1,"btn-sm","btn-secondary",3,"click"],[1,"empty-state"]],template:function(o,t){o&1&&(i(0,"div",0)(1,"div",1)(2,"h2"),a(3,"\u{1F4CA} Stats / Ratings"),n(),i(4,"p"),a(5,"Manage statistics displayed on the home page"),n(),S(6,L,2,0,"button",2),n(),S(7,D,2,1,"div",3)(8,z,2,0,"div",4)(9,A,28,5,"div",5)(10,H,17,1,"table",6)(11,R,3,0,"div",7),n()),o&2&&(s(6),u("ngIf",!t.isCreating),s(),u("ngIf",t.error),s(),u("ngIf",t.loading),s(),u("ngIf",t.isCreating),s(),u("ngIf",t.stats.length>0&&!t.loading),s(),u("ngIf",t.stats.length===0&&!t.loading&&!t.isCreating))},dependencies:[k,P,O,F,I,B,W,T],styles:[".stats-page[_ngcontent-%COMP%]{padding:2rem;max-width:1200px}.page-header[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;gap:1rem;margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{flex:1;color:#888;margin:0}.btn-primary[_ngcontent-%COMP%]{background:#4f46e5;color:#fff;border:none;padding:.625rem 1.25rem;border-radius:6px;cursor:pointer;font-weight:500}.btn-primary[_ngcontent-%COMP%]:hover{background:#4338ca}.btn-success[_ngcontent-%COMP%]{background:#10b981;color:#fff;border:none;padding:.5rem 1rem;border-radius:6px;cursor:pointer}.btn-success[_ngcontent-%COMP%]:hover{background:#059669}.btn-secondary[_ngcontent-%COMP%]{background:#6b7280;color:#fff;border:none;padding:.5rem 1rem;border-radius:6px;cursor:pointer}.btn-secondary[_ngcontent-%COMP%]:hover{background:#4b5563}.btn-sm[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem;border-radius:4px;border:none;cursor:pointer}.btn-edit[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.btn-edit[_ngcontent-%COMP%]:hover{background:#2563eb}.btn-danger[_ngcontent-%COMP%]{background:#ef4444;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover{background:#dc2626}.error-msg[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626;padding:.75rem 1rem;border-radius:6px;margin-bottom:1rem}.loading[_ngcontent-%COMP%]{color:#888;padding:2rem;text-align:center}.stat-form[_ngcontent-%COMP%]{background:#f9fafb;padding:1.5rem;border-radius:8px;margin-bottom:2rem}.stat-form[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.125rem}.form-row[_ngcontent-%COMP%]{margin-bottom:1rem;display:flex;align-items:center;gap:1rem}.form-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:100px;font-weight:500}.form-row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:.5rem;border:1px solid #d1d5db;border-radius:6px;font-size:.875rem}.form-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:1rem}.stats-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 1px 3px #0000001a}.stats-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .stats-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;text-align:left;border-bottom:1px solid #e5e7eb}.stats-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f9fafb;font-weight:600;font-size:.75rem;text-transform:uppercase;color:#6b7280}.stats-table[_ngcontent-%COMP%]   .icon-cell[_ngcontent-%COMP%]{font-size:1.25rem}.stats-table[_ngcontent-%COMP%]   .actions-cell[_ngcontent-%COMP%]{display:flex;gap:.5rem}.input-sm[_ngcontent-%COMP%]{width:100%;padding:.375rem .5rem;border:1px solid #d1d5db;border-radius:4px;font-size:.875rem}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#9ca3af}"]})}}return l})();export{Y as StatsComponent};
