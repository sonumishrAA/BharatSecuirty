import{a as N}from"./chunk-DZXTVIH6.js";import{b as z,e as A,j as L,t as F}from"./chunk-OBZSDWM5.js";import"./chunk-GY5U62TY.js";import"./chunk-RT5UYCHB.js";import{$a as k,Ab as i,Bb as c,Cb as w,Eb as y,Fb as E,Gb as B,Ia as h,Ib as I,Na as o,Oa as S,_ as O,bb as p,db as P,eb as v,fb as M,gc as D,ha as _,hc as T,ia as b,kb as t,lb as n,oc as V,qb as x,rb as g,sb as d}from"./chunk-V2IGFCHU.js";function U(l,u){if(l&1){let e=x();t(0,"div",4)(1,"span",13),i(2),n(),t(3,"button",14),g("click",function(){_(e);let a=d();return b(a.bulkDelete())}),i(4,"\u{1F5D1} Delete Selected"),n()()}if(l&2){let e=d();o(2),w("",e.selectedCount," selected")}}function R(l,u){if(l&1&&(t(0,"div",25)(1,"label"),i(2,"Additional Info"),n(),t(3,"p",26),i(4),n()()),l&2){let e=d(2);o(4),c(e.selectedBooking.additional_info)}}function $(l,u){if(l&1&&(t(0,"div",21)(1,"label"),i(2,"Attachment"),n(),t(3,"a",29),i(4,"\u{1F4CE} Download File"),n()()),l&2){let e=d(2);o(3),p("href",e.selectedBooking.attachment_url,h)}}function W(l,u){if(l&1){let e=x();t(0,"div",15),g("click",function(){_(e);let a=d();return b(a.closeDetails())}),t(1,"div",16),g("click",function(a){return _(e),b(a.stopPropagation())}),t(2,"div",17)(3,"h3"),i(4,"Booking Details"),n(),t(5,"button",18),g("click",function(){_(e);let a=d();return b(a.closeDetails())}),i(6,"\u2715"),n()(),t(7,"div",19)(8,"div",20)(9,"div",21)(10,"label"),i(11,"Date"),n(),t(12,"span"),i(13),n()(),t(14,"div",21)(15,"label"),i(16,"Status"),n(),t(17,"span",22),i(18),n()(),t(19,"div",21)(20,"label"),i(21,"Name"),n(),t(22,"span"),i(23),n()(),t(24,"div",21)(25,"label"),i(26,"Email"),n(),t(27,"a",23),i(28),n()(),t(29,"div",21)(30,"label"),i(31,"Company"),n(),t(32,"span"),i(33),n()(),t(34,"div",21)(35,"label"),i(36,"Phone"),n(),t(37,"span"),i(38),n()(),t(39,"div",21)(40,"label"),i(41,"Service Type"),n(),t(42,"span",24),i(43),n()(),t(44,"div",21)(45,"label"),i(46,"Temp Password"),n(),t(47,"code"),i(48),n()(),t(49,"div",25)(50,"label"),i(51,"Message"),n(),t(52,"p",26),i(53),n()(),k(54,R,5,1,"div",27)(55,$,5,1,"div",28),n()()()()}if(l&2){let e=d();o(13),c(e.formatDate(e.selectedBooking.created_at)),o(4),v(e.selectedBooking.status),o(),c(e.selectedBooking.status||"pending"),o(5),c(e.selectedBooking.contact_name),o(4),p("href","mailto:"+e.selectedBooking.contact_email,h),o(),c(e.selectedBooking.contact_email),o(5),c(e.selectedBooking.company||"-"),o(5),c(e.selectedBooking.phone||"-"),o(5),c(e.selectedBooking.service_type||e.selectedBooking.service_title||"General"),o(5),c(e.selectedBooking.temp_password||"N/A"),o(5),c(e.selectedBooking.message),o(),p("ngIf",e.selectedBooking.additional_info),o(),p("ngIf",e.selectedBooking.attachment_url)}}function q(l,u){if(l&1){let e=x();t(0,"tr")(1,"td",9)(2,"input",30),g("change",function(){let a=_(e).$implicit,s=d();return b(s.toggleSelection(a.id))}),n()(),t(3,"td",31),i(4),n(),t(5,"td")(6,"div",32)(7,"span",33),i(8),n()()(),t(9,"td"),i(10),n(),t(11,"td")(12,"span",24),i(13),n()(),t(14,"td")(15,"a",23),i(16),n()(),t(17,"td")(18,"span",22),i(19),n()(),t(20,"td",34)(21,"button",35),g("click",function(){let a=_(e).$implicit,s=d();return b(s.viewDetails(a))}),i(22,"\u{1F441}"),n(),t(23,"button",36),g("click",function(){let a=_(e).$implicit,s=d();return b(s.deleteBooking(a.id))}),i(24,"\u{1F5D1}"),n()()()}if(l&2){let e=u.$implicit,r=d();P("selected",r.isSelected(e.id)),o(2),p("checked",r.isSelected(e.id)),o(2),c(r.formatDate(e.created_at)),o(4),c(e.contact_name),o(2),c(e.company||"-"),o(3),c(e.service_type||e.service_title||"General"),o(2),p("href","mailto:"+e.contact_email,h),o(),c(e.contact_email),o(2),v(e.status),o(),c(e.status||"pending")}}function G(l,u){l&1&&(t(0,"tr")(1,"td",37),i(2," No inquiries found. "),n()())}function H(l,u){l&1&&(t(0,"tr")(1,"td",38),i(2," Loading... "),n()())}var ee=(()=>{class l{constructor(e){this.adminService=e,this.bookings=[],this.isLoading=!0,this.selectedBooking=null,this.selectedIds=new Set,this.selectAll=!1}ngOnInit(){this.loadBookings()}loadBookings(){this.isLoading=!0,this.selectedIds.clear(),this.selectAll=!1,this.adminService.getBookings().subscribe({next:e=>{this.bookings=e,this.isLoading=!1},error:e=>{console.error("Failed to load bookings",e),this.isLoading=!1}})}toggleSelectAll(){this.selectAll?this.bookings.forEach(e=>this.selectedIds.add(e.id)):this.selectedIds.clear()}toggleSelection(e){this.selectedIds.has(e)?this.selectedIds.delete(e):this.selectedIds.add(e),this.selectAll=this.selectedIds.size===this.bookings.length}isSelected(e){return this.selectedIds.has(e)}get selectedCount(){return this.selectedIds.size}deleteBooking(e){confirm("Are you sure you want to delete this booking?")&&this.adminService.deleteBooking(e).subscribe({next:()=>{this.bookings=this.bookings.filter(r=>r.id!==e),this.selectedIds.delete(e)},error:r=>console.error("Delete failed",r)})}bulkDelete(){if(this.selectedIds.size===0||!confirm(`Delete ${this.selectedIds.size} selected booking(s)?`))return;let e=Array.from(this.selectedIds);this.adminService.bulkDeleteBookings(e).subscribe({next:()=>{this.bookings=this.bookings.filter(r=>!this.selectedIds.has(r.id)),this.selectedIds.clear(),this.selectAll=!1},error:r=>console.error("Bulk delete failed",r)})}exportCSV(){let e=["Date","Name","Email","Company","Phone","Service","Message","Status"],r=this.bookings.map(m=>[this.formatDate(m.created_at),m.contact_name,m.contact_email,m.company||"",m.phone||"",m.service_type||m.service_title||"",(m.message||"").replace(/\n/g," "),m.status||"pending"]),a=[e,...r].map(m=>m.map(j=>`"${j}"`).join(",")).join(`
`),s=new Blob([a],{type:"text/csv"}),f=URL.createObjectURL(s),C=document.createElement("a");C.href=f,C.download=`bookings_${new Date().toISOString().split("T")[0]}.csv`,C.click(),URL.revokeObjectURL(f)}viewDetails(e){this.selectedBooking=e}closeDetails(){this.selectedBooking=null}formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}getAttachmentName(e){return e?e.split("/").pop()||"File":""}static{this.\u0275fac=function(r){return new(r||l)(S(N))}}static{this.\u0275cmp=O({type:l,selectors:[["app-bookings"]],standalone:!0,features:[I],decls:35,vars:6,consts:[[1,"page-header"],[1,"actions"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"bulk-actions"],[1,"modal-overlay"],[1,"card"],[1,"table-container"],[1,"data-table"],[1,"checkbox-col"],["type","checkbox",3,"ngModelChange","change","ngModel"],[3,"selected",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"selection-count"],[1,"btn","btn-danger",3,"click"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"btn-close",3,"click"],[1,"modal-body"],[1,"detail-grid"],[1,"detail-item"],[1,"badge"],[3,"href"],[1,"badge","service"],[1,"detail-item","full-width"],[1,"message-text"],["class","detail-item full-width",4,"ngIf"],["class","detail-item",4,"ngIf"],["target","_blank",1,"download-link",3,"href"],["type","checkbox",3,"change","checked"],[1,"nowrap"],[1,"user-info"],[1,"name"],[1,"actions-cell"],[1,"btn","btn-view",3,"click"],[1,"btn","btn-delete",3,"click"],["colspan","8",1,"empty-state"],["colspan","8",1,"loading-state"]],template:function(r,a){r&1&&(t(0,"div",0)(1,"h2"),i(2,"Inquiries / Bookings"),n(),t(3,"div",1)(4,"button",2),g("click",function(){return a.exportCSV()}),i(5," \u{1F4E5} Export CSV "),n(),t(6,"button",3),g("click",function(){return a.loadBookings()}),i(7," \u21BB Refresh "),n()()(),k(8,U,5,1,"div",4)(9,W,56,14,"div",5),t(10,"div",6)(11,"div",7)(12,"table",8)(13,"thead")(14,"tr")(15,"th",9)(16,"input",10),B("ngModelChange",function(f){return E(a.selectAll,f)||(a.selectAll=f),f}),g("change",function(){return a.toggleSelectAll()}),n()(),t(17,"th"),i(18,"Date"),n(),t(19,"th"),i(20,"Name"),n(),t(21,"th"),i(22,"Company"),n(),t(23,"th"),i(24,"Service"),n(),t(25,"th"),i(26,"Email"),n(),t(27,"th"),i(28,"Status"),n(),t(29,"th"),i(30,"Actions"),n()()(),t(31,"tbody"),k(32,q,25,12,"tr",11)(33,G,3,0,"tr",12)(34,H,3,0,"tr",12),n()()()()),r&2&&(o(8),M(8,a.selectedCount>0?8:-1),o(),M(9,a.selectedBooking?9:-1),o(7),y("ngModel",a.selectAll),o(16),p("ngForOf",a.bookings),o(),p("ngIf",a.bookings.length===0&&!a.isLoading),o(),p("ngIf",a.isLoading))},dependencies:[V,D,T,F,z,A,L],styles:[".page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600;color:#111827}.page-header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.page-header[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:.375rem;border:none;cursor:pointer;display:flex;align-items:center;gap:.5rem;font-weight:500;transition:all .2s}.page-header[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]{background:#2563eb;color:#fff}.page-header[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:hover{background:#1d4ed8}.page-header[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.page-header[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb}.bulk-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:.75rem 1rem;background:#fef3c7;border-radius:.375rem;margin-bottom:1rem}.bulk-actions[_ngcontent-%COMP%]   .selection-count[_ngcontent-%COMP%]{font-weight:500;color:#92400e}.bulk-actions[_ngcontent-%COMP%]   .btn-danger[_ngcontent-%COMP%]{background:#dc2626;color:#fff;padding:.375rem .75rem;border:none;border-radius:.25rem;cursor:pointer;font-size:.875rem}.bulk-actions[_ngcontent-%COMP%]   .btn-danger[_ngcontent-%COMP%]:hover{background:#b91c1c}.checkbox-col[_ngcontent-%COMP%]{width:40px;text-align:center}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:.25rem}.btn-delete[_ngcontent-%COMP%]{padding:.25rem .5rem;background:#fee2e2;color:#dc2626;border:none;border-radius:.25rem;cursor:pointer;font-size:.75rem}.btn-delete[_ngcontent-%COMP%]:hover{background:#fecaca}tr.selected[_ngcontent-%COMP%]{background:#eff6ff!important}.card[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;overflow:hidden}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.875rem}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#f9fafb}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.75rem 1.5rem;text-align:left;font-weight:500;color:#6b7280;text-transform:uppercase;font-size:.75rem;letter-spacing:.05em}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-top:1px solid #e5e7eb}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f9fafb}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem 1.5rem;color:#374151;vertical-align:top}.nowrap[_ngcontent-%COMP%]{white-space:nowrap}.user-info[_ngcontent-%COMP%]{font-weight:500;color:#111827}.badge[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:9999px;font-size:.75rem;font-weight:500}.badge.service[_ngcontent-%COMP%]{background:#eff6ff;color:#1e40af}.message-cell[_ngcontent-%COMP%]{max-width:300px;color:#6b7280}.download-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.25rem;color:#2563eb;text-decoration:none;font-size:.8rem}.download-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.empty-state[_ngcontent-%COMP%], .loading-state[_ngcontent-%COMP%]{text-align:center;padding:3rem!important;color:#6b7280}.badge.pending[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.badge.in_progress[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.badge.completed[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.badge.cancelled[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.btn-view[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem;background:#f3f4f6;color:#374151;border:none;border-radius:.25rem;cursor:pointer}.btn-view[_ngcontent-%COMP%]:hover{background:#e5e7eb}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:.5rem;width:90%;max-width:600px;max-height:80vh;overflow-y:auto;box-shadow:0 25px 50px -12px #00000040}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 1.5rem;border-bottom:1px solid #e5e7eb}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.btn-close[_ngcontent-%COMP%]{background:none;border:none;font-size:1.25rem;cursor:pointer;color:#6b7280}.btn-close[_ngcontent-%COMP%]:hover{color:#374151}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.detail-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.detail-item.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.detail-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.75rem;color:#6b7280;text-transform:uppercase;margin-bottom:.25rem}.detail-item[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:#f3f4f6;padding:.25rem .5rem;border-radius:.25rem;font-size:.8rem}.message-text[_ngcontent-%COMP%]{margin:0;white-space:pre-wrap;background:#f9fafb;padding:.75rem;border-radius:.25rem;font-size:.875rem}"]})}}return l})();export{ee as BookingsComponent};
