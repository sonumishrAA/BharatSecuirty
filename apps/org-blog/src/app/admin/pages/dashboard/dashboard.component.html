<div class="dashboard">
    <div class="dashboard-header">
        <div class="header-left">
            <h1>Dashboard</h1>
            <p class="muted">Manage all your blog posts</p>
        </div>
        <button class="btn-primary" (click)="router.navigate(['/admin/editor'])">
            <span class="material-icons-round">add</span>
            New Post
        </button>
    </div>

    @if (loading()) {
    <div class="loading-state">
        <span class="spinner"></span>
        <span>Loading posts...</span>
    </div>
    }

    <div class="card">
        <table class="posts-table">
            <thead>
                <tr>
                    <th>Post</th>
                    <th>Category</th>
                    <th>Status</th>
                    <th>Published</th>
                    <th>Actions</th>
                </tr>
            </thead>

            <tbody>
                @for (post of posts(); track post.id) {
                <tr class="post-row">
                    <!-- TITLE + COVER -->
                    <td>
                        <div class="post-title">
                            @if (post.cover_image_url) {
                            <img [src]="post.cover_image_url" alt="" class="post-thumb" />
                            } @else {
                            <div class="post-thumb placeholder">
                                <span class="material-icons-round">image</span>
                            </div>
                            }
                            <span class="title-text">{{ post.title }}</span>
                        </div>
                    </td>

                    <!-- CATEGORY -->
                    <td>
                        <span class="badge">{{ post.category || 'â€”' }}</span>
                    </td>

                    <!-- STATUS -->
                    <td>
                        <span class="status" [class.published]="post.status === 'published'"
                            [class.draft]="post.status === 'draft'">
                            <span class="material-icons-round">
                                {{ post.status === 'published' ? 'check_circle' : 'edit' }}
                            </span>
                            {{ post.status }}
                        </span>
                    </td>

                    <!-- TOGGLE -->
                    <td>
                        <label class="ios-toggle">
                            <input type="checkbox" [checked]="post.status === 'published'"
                                (change)="toggleStatus(post)" />
                            <span class="slider"></span>
                        </label>
                    </td>

                    <!-- ACTIONS -->
                    <td>
                        <div class="actions">
                            <button class="btn-icon" (click)="editPost(post.id)" title="Edit">
                                <span class="material-icons-round">edit</span>
                            </button>
                            <button class="btn-icon danger" (click)="deletePost(post.id)" title="Delete">
                                <span class="material-icons-round">delete</span>
                            </button>
                        </div>
                    </td>
                </tr>
                }

                @if (!loading() && posts().length === 0) {
                <tr>
                    <td colspan="5">
                        <div class="empty-state">
                            <span class="material-icons-round">article</span>
                            <p>No posts yet</p>
                            <button class="btn-secondary" (click)="router.navigate(['/admin/editor'])">
                                Create your first post
                            </button>
                        </div>
                    </td>
                </tr>
                }
            </tbody>
        </table>
    </div>
</div>